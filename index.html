<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>

    <title>noio/Sausagefest @ GitHub</title>
    <script src="ender.min.js" type="text/javascript" charset="utf-8"></script>

    <style type="text/css">
        body {
        margin-top: 1.0em;
        background-color: #230f24;
        font-family: Helvetica, Arial, FreeSans, san-serif;
        color: #ffffff;
        }
        #container { margin: 0 auto;
                     width: 800px; }
        #icons #male { width: 400px; float: left; }
        #icons #female {width: 400px; float: left; text-align: right;}
        
        #icons span { display: block; width: 60px; height: 120px; text-indent:-9999px;}
        span.male   { background: url('male.png'); }
        span.female { background: url('female.png'); float:right;}
    </style>
    <script type="text/javascript" charset="utf-8">
    // Beaver town
    // The pie zone
    // Taco fiesta
    // Fish market
    // Oyster farm
    // Banana republic
    // Dong city
    </script>
  
</head>

<body>
    <div id="fb-root"></div>
    <script>
    bonzo = require('bonzo');
    
    window.fbAsyncInit = function() {
      FB.init({
        appId      : '376545645690668', // App ID
        channelUrl : '//noio.github.com/Sausagefest/channel.html', // Channel File
        status     : true, // check login status
        cookie     : true, // enable cookies to allow the server to access the session
        xfbml      : true  // parse XFBML
      });


    };

    // Load the SDK Asynchronously
    (function(d){
       var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
       if (d.getElementById(id)) {return;}
       js = d.createElement('script'); js.id = id; js.async = true;
       js.src = "http://connect.facebook.net/en_US/all.js";
       ref.parentNode.insertBefore(js, ref);
     }(document));
     
    function login(){
        FB.login(function(response) {
           if (response.authResponse) {
             console.log('Welcome!  Fetching your information.... ');
             FB.api('/me', function(response) {
               console.log('' + response.name + ' logged in.');
             });
             attending('300480070013266');
           } else {
             console.log('User cancelled login or did not fully authorize.');
           }
         });
    }
    
    window.attendees = {'1':{'gender':'male'},'2':{'gender':'female'}};
    function attending(eid){
        FB.api('/'+eid+'/attending', function(response){
            window.attendees = {}
            for (var i = 0; i < response.data.length; i++){

                FB.api('/'+response.data[i].id, function(person){
                    window.attendees[person.id] = person;
                });           
            }
        });
    }
    
    function vis(){
        for (id in window.attendees)
        {
            var person = window.attendees[id];
            var g = person.gender;
            var span = $("<span>").addClass(g);
            $('#icons #'+g).append(span);
            span.fadeIn(1000);
        }
    }
    </script>
  
    <div id='container'>
        <a href="#" onclick="login(); return false;">Check on this event: </a>
        <div id='icons'>
            <div id='female'></div>
            <div id='male'></div>
        </div>
    </div>
<script type="text/javascript" charset="utf-8">
vis()
</script>
</body>
</html>
